<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title data-i18n="title">Ø§ØªØ­Ø§Ø¯ Ø·Ø¨ Ø¨Ø´Ø±ÙŠ ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</title>
<meta name="theme-color" content="#101214"/>

<style>
:root{
  --bg1:#0e0f11; --bg2:#121316;
  --card:rgba(255,255,255,.06);
  --txt:#eef0f2; --mut:#a9adb3; --bor:rgba(255,255,255,.10);
  --ring:rgba(16,185,129,.35);
  --acc1:#10b981; --acc2:#f59e0b;
  --shadow:0 10px 30px rgba(0,0,0,.22), inset 0 1px 0 rgba(255,255,255,.04);
  --radius-xl:18px; --radius-lg:14px; --radius-md:12px;
  --pad:14px; --gap:12px; --blur:10px;
}
:root.light{
  --bg1:#f6f7f8; --bg2:#ffffff; --card:rgba(255,255,255,.92);
  --txt:#171717; --mut:#5b6066; --bor:rgba(0,0,0,.10);
  --ring:rgba(245,158,11,.35);
  --acc1:#16a34a; --acc2:#ea580c;
  --shadow:0 10px 30px rgba(0,0,0,.1), inset 0 1px 0 rgba(255,255,255,.9);
}
*{box-sizing:border-box} html,body{height:100%}
body{
  margin:0; font:16px/1.75 ui-rounded,system-ui,Segoe UI,Arial;
  color:var(--txt);
  background:linear-gradient(160deg,var(--bg1),var(--bg2)) fixed;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}
.topbar{position:sticky;top:0;z-index:20;display:flex;justify-content:space-between;align-items:center;
  padding:12px 16px;background:linear-gradient(160deg,rgba(0,0,0,.28),rgba(0,0,0,.12));
  backdrop-filter:blur(var(--blur));border-bottom:1px solid var(--bor)}
.brand{font-weight:800;letter-spacing:.2px}
.badge{border:1px solid var(--bor);border-radius:999px;padding:6px 12px;background:rgba(255,255,255,.06);color:var(--mut);font-size:12px}
.container{max-width:1050px;margin:0 auto;padding:18px}
.view.hidden{display:none}
.card{background:var(--card);border:1px solid var(--bor);border-radius:var(--radius-xl);
  padding:var(--pad);box-shadow:var(--shadow);backdrop-filter:blur(var(--blur));transition:transform .12s}
.card:hover{transform:translateY(-1px)}
.separator{height:1px;background:var(--bor);margin:10px 0;border-radius:999px}
.grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--gap)}
@media(max-width:840px){.grid{grid-template-columns:1fr}}
textarea,input,select,button{border:1px solid var(--bor);border-radius:var(--radius-md);
  background:rgba(0,0,0,.18);color:var(--txt);padding:10px 12px;outline:none;transition:.15s}
textarea{min-height:100px;resize:vertical}
input:focus,textarea:focus,select:focus{border-color:color-mix(in srgb,var(--acc1) 45%,#000);box-shadow:0 0 0 4px var(--ring)}
button{cursor:pointer;border-radius:var(--radius-lg);font-weight:700;
  background:linear-gradient(135deg,color-mix(in srgb,var(--acc1) 55%,transparent),color-mix(in srgb,var(--acc2) 45%,transparent));
  color:#fff;border:1px solid var(--bor);padding:10px 14px;box-shadow:0 6px 20px rgba(0,0,0,.18)}
button:hover{filter:brightness(1.05)} button:active{transform:translateY(1px)}
button.ghost{background:rgba(255,255,255,.04);color:var(--txt)}
.muted{color:var(--mut);font-size:13px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.bottom{position:sticky;bottom:0;z-index:15;display:flex;justify-content:space-around;gap:10px;padding:12px;
  background:linear-gradient(0deg,rgba(0,0,0,.28),rgba(0,0,0,.12));border-top:1px solid var(--bor);backdrop-filter:blur(var(--blur))}
.bottom button{flex:1;text-align:center}.bottom .active{box-shadow:0 0 0 3px var(--ring) inset}
.post{border:1px solid var(--bor);border-radius:12px;padding:12px;background:rgba(0,0,0,.18)}
.alert{position:fixed;left:10px;right:10px;bottom:80px;background:#b91c1c;color:#fff;padding:10px;border-radius:12px;z-index:9999;display:none}
.alert.show{display:block}

/* ===== Modal ===== */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;
  place-items:center;z-index:40;padding:14px}
.modal .box{width:min(520px,100%);background:var(--card);border:1px solid var(--bor);
  border-radius:16px;padding:16px;box-shadow:var(--shadow);backdrop-filter:blur(10px)}
.modal .head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.modal .head h3{margin:0}
</style>
</head>
<body>

<header class="topbar">
  <div class="brand" data-i18n="title">Ø§ØªØ­Ø§Ø¯ Ø·Ø¨ Ø¨Ø´Ø±ÙŠ ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</div>
  <div class="row">
    <button id="btnOpenAuth" class="ghost"
      onclick="document.getElementById('authModal').style.display='grid'">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    <div class="badge" id="statusBadge">â€¦</div>
  </div>
</header>

<main class="container">

  <!-- Ø¹Ø§Ù… -->
  <section id="view-home" class="view">
    <div class="card">
      <div style="display:flex;align-items:center;gap:14px">
        <div style="font-size:40px">ğŸ§±</div>
        <div>
          <h2 style="margin:0 0 6px" data-i18n="ready">Ø¬Ø§Ù‡Ø²ÙŠÙ†</h2>
          <p style="margin:0" data-i18n="desc">
            Ù†Ø³Ø®Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„ØªØ£ÙƒØ¯ Ø£Ù† GitHub Pages Ø´ØºØ§Ù„. Ø¯Ù„ÙˆÙ‚ØªÙŠ Ø±Ø¨Ø·Ù†Ø§ Firebase ÙƒÙ…Ø§Ù†ØŒ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ Ù‡Ù†Ø¶ÙŠÙ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø§Ù„Ø¨ÙˆØ³ØªØ§ØªØŒ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ØŒ QRâ€¦ Ø¥Ù„Ø®.
          </p>
          <div class="separator"></div>
          <p class="muted" style="margin:0" data-i18n="badgeNote">
            Ù„Ùˆ Ø§Ù„Ø´Ø§Ø±Ø© ÙÙˆÙ‚ Ø¨Ù‚Øª âœ“ Firebase Ù…Ø±ØªØ¨Ø· ÙŠØ¨Ù‚Ù‰ Ø§Ù„Ø±Ø¨Ø· Ù†Ø¬Ø­.
          </p>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="grid">
        <div>
          <label class="muted" data-i18n="fontSize">Ø­Ø¬Ù… Ø§Ù„Ù†Øµ</label>
          <select id="fontSizeSel">
            <option value="16" data-i18n="fsDefault">Ø§ÙØªØ±Ø§Ø¶ÙŠ</option>
            <option value="17" data-i18n="fsLarge">ÙƒØ¨ÙŠØ±</option>
            <option value="18" data-i18n="fsXL">Ø£ÙƒØ¨Ø±</option>
          </select>
        </div>
        <div>
          <label class="muted" data-i18n="theme">Ø§Ù„ÙˆØ¶Ø¹</label><br/>
          <button id="themeToggle" class="ghost" data-i18n="toggleTheme">ØªØ¨Ø¯ÙŠÙ„ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ</button>
        </div>
      </div>
      <p class="muted" style="margin:.6rem 0 0" data-i18n="prefsNote">
        * Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª ØªØªØ®Ø²Ù‘Ù† Ù…Ø­Ù„ÙŠÙ‹Ø§ â€” Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù‡Ù†ÙØ¹Ù„Ù‡Ø§ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.
      </p>
    </div>

    <div class="card">
      <h3 style="margin-top:0" data-i18n="publicPosts">Ø¨ÙˆØ³ØªØ§Øª Ø¹Ø§Ù…Ø© (placeholder)</h3>
      <div class="post">ğŸ‰ <span data-i18n="post1">Ø¥Ø¹Ù„Ø§Ù† Ù†Ø¯ÙˆØ© ØªØ¹Ø±ÙŠÙÙŠØ© â€” Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©</span></div>
      <div class="post">ğŸ—“ï¸ <span data-i18n="post2">ÙØ¹Ø§Ù„ÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ© Ø¯Ø§Ø®Ù„ÙŠØ© â€” placeholder</span></div>
    </div>
  </section>

  <!-- Ø¨Ø±ÙˆÙØ§ÙŠÙ„ -->
  <section id="view-profile" class="view hidden">
    <div class="card">
      <h2 style="margin-top:0" data-i18n="profile">Ø¨Ø±ÙˆÙØ§ÙŠÙ„</h2>
      <div class="grid">
        <div>
          <label class="muted" data-i18n="name">Ø§Ù„Ø§Ø³Ù…</label>
          <input id="pName" placeholder="â€”" value="Mahmoud Emara">
        </div>
        <div>
          <label class="muted" data-i18n="email">Ø§Ù„Ø¨Ø±ÙŠØ¯</label>
          <input id="pEmail" placeholder="â€”" value="dr.emara10@gmail.com">
        </div>
        <div>
          <label class="muted" data-i18n="age">Ø§Ù„Ø¹Ù…Ø±</label>
          <input id="pAge" type="number" min="16" max="100" placeholder="â€”" value="18">
        </div>
        <div>
          <label class="muted" data-i18n="batch">Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹Ø©</label>
          <input id="pBatch" placeholder="â€”" value="12">
        </div>
      </div>
      <div class="row" style="margin-top:10px">
        <button class="ghost" id="btnSaveProfile" data-i18n="saveLocal">Ø­ÙØ¸ (Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø§Ù„Ø¢Ù†)</button>
      </div>
      <p class="muted" style="margin:.6rem 0 0" data-i18n="profileNote">
        * ÙÙŠ Ù…Ø±Ø­Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‡Ù†Ø±Ø¨Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠ Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….
      </p>
    </div>
  </section>

  <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
  <section id="view-settings" class="view hidden">
    <div class="card">
      <h2 style="margin-top:0" data-i18n="settings">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <div class="grid">
        <div>
          <label class="muted" data-i18n="language">Ø§Ù„Ù„ØºØ©</label>
          <select id="langSel">
            <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            <option value="en">English</option>
            <option value="es">EspaÃ±ol</option>
            <option value="fr">FranÃ§ais</option>
            <option value="de">Deutsch</option>
          </select>
        </div>
        <div>
          <label class="muted" data-i18n="customize">ØªØ®ØµÙŠØµ</label><br/>
          <button class="ghost" id="btnClearLocal" data-i18n="clearPrefs">Ù…Ø³Ø­ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²</button>
        </div>
      </div>
      <p class="muted" style="margin:.6rem 0 0" data-i18n="laterNote">
        * Ù„Ø§Ø­Ù‚Ù‹Ø§ Ù‡Ù†Ø¶ÙŠÙ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±ÙØŒ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§ØªØŒ ÙˆÙ…Ø³Ø­ QR Ù„Ù„Ø­Ø¶ÙˆØ±.
      </p>
    </div>
  </section>

</main>

<nav class="bottom">
  <button class="active" data-view="view-home" data-i18n="tabHome">ğŸ  Ø¹Ø§Ù…</button>
  <button data-view="view-profile" data-i18n="tabProfile">ğŸ‘¤ Ø¨Ø±ÙˆÙØ§ÙŠÙ„</button>
  <button data-view="view-settings" data-i18n="tabSettings">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
</nav>

<!-- ====== AUTH MODAL ====== -->
<div id="authModal" class="modal">
  <div class="box">
    <div class="head">
      <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
      <button id="btnCloseAuth" class="ghost"
        onclick="document.getElementById('authModal').style.display='none'">âœ–</button>
    </div>
    <div class="grid">
      <div>
        <label class="muted">Ø§Ù„Ø§Ø³Ù… (ÙŠØ¸Ù‡Ø± Ù„Ù„Ù†Ø§Ø³)</label>
        <input id="authName" placeholder="Ø§Ø³Ù…Ùƒ">
      </div>
      <div>
        <label class="muted">Ø§Ù„Ø¨Ø±ÙŠØ¯</label>
        <input id="authEmail" placeholder="you@example.com">
      </div>
      <div>
        <label class="muted">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</label>
        <input id="authPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
      </div>
      <div class="row" style="align-items:flex-end">
        <button id="btnEmailSignUp">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯</button>
        <button id="btnEmailSignIn" class="ghost">Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯</button>
      </div>
    </div>
    <div class="separator"></div>
    <button id="btnGoogle" style="width:100%">Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Google</button>
    <div class="row" style="margin-top:8px;justify-content:space-between">
      <div class="muted" id="authHint"></div>
      <button id="btnSignOut" class="ghost">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>
  </div>
</div>

<div class="alert" id="errBox"></div>

<!-- ===== Client (nav + theme + i18n + local prefs) ===== -->
<script>
(function(){
  // theme boot
  const t=localStorage.getItem('theme'); if(t==='light') document.documentElement.classList.add('light');

  // font size
  const sel=document.getElementById('fontSizeSel');
  if(sel){
    const fs=localStorage.getItem('fs'); if(fs){document.body.style.fontSize=fs+'px'; sel.value=fs;}
    sel.onchange=()=>{document.body.style.fontSize=sel.value+'px'; localStorage.setItem('fs',sel.value);};
  }
  // toggle theme
  const tg=document.getElementById('themeToggle');
  if(tg){tg.onclick=()=>{const isLight=document.documentElement.classList.toggle('light');
    localStorage.setItem('theme', isLight ? 'light':'dark');};}

  // bottom nav routing
  const buttons=document.querySelectorAll('.bottom button');
  const views=document.querySelectorAll('.view');
  function show(id){
    views.forEach(v=>v.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    buttons.forEach(b=>b.classList.toggle('active', b.dataset.view===id));
  }
  buttons.forEach(b=>b.addEventListener('click',()=>show(b.dataset.view)));
  show('view-home');

  // profile local save
  const save=document.getElementById('btnSaveProfile');
  if(save){
    save.onclick=()=>{
      const data={
        name:document.getElementById('pName').value||'',
        email:document.getElementById('pEmail').value||'',
        age:document.getElementById('pAge').value||'',
        batch:document.getElementById('pBatch').value||''
      };
      localStorage.setItem('profileDraft', JSON.stringify(data));
      save.textContent='âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§';
      setTimeout(()=>save.textContent=document.querySelector('[data-i18n="saveLocal"]').textContent,1500);
    };
    const draft=localStorage.getItem('profileDraft');
    if(draft){
      const d=JSON.parse(draft);
      document.getElementById('pName').value=d.name||'';
      document.getElementById('pEmail').value=d.email||'';
      document.getElementById('pAge').value=d.age||'';
      document.getElementById('pBatch').value=d.batch||'';
    }
  }

  // ====== i18n ======
  const dict={
    ar:{title:"Ø§ØªØ­Ø§Ø¯ Ø·Ø¨ Ø¨Ø´Ø±ÙŠ ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®",ready:"Ø¬Ø§Ù‡Ø²ÙŠÙ†",desc:"Ù†Ø³Ø®Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„ØªØ£ÙƒØ¯ Ø£Ù† GitHub Pages Ø´ØºØ§Ù„. Ø¯Ù„ÙˆÙ‚ØªÙŠ Ø±Ø¨Ø·Ù†Ø§ Firebase ÙƒÙ…Ø§Ù†ØŒ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ Ù‡Ù†Ø¶ÙŠÙ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø§Ù„Ø¨ÙˆØ³ØªØ§ØªØŒ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ØŒ QRâ€¦ Ø¥Ù„Ø®.",
      badgeNote:"Ù„Ùˆ Ø§Ù„Ø´Ø§Ø±Ø© ÙÙˆÙ‚ Ø¨Ù‚Øª âœ“ Firebase Ù…Ø±ØªØ¨Ø· ÙŠØ¨Ù‚Ù‰ Ø§Ù„Ø±Ø¨Ø· Ù†Ø¬Ø­.",fontSize:"Ø­Ø¬Ù… Ø§Ù„Ù†Øµ",fsDefault:"Ø§ÙØªØ±Ø§Ø¶ÙŠ",fsLarge:"ÙƒØ¨ÙŠØ±",fsXL:"Ø£ÙƒØ¨Ø±",
      theme:"Ø§Ù„ÙˆØ¶Ø¹",toggleTheme:"ØªØ¨Ø¯ÙŠÙ„ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ",prefsNote:"* Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª ØªØªØ®Ø²Ù‘Ù† Ù…Ø­Ù„ÙŠÙ‹Ø§ â€” Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù‡Ù†ÙØ¹Ù„Ù‡Ø§ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.",
      publicPosts:"Ø¨ÙˆØ³ØªØ§Øª Ø¹Ø§Ù…Ø© (placeholder)",post1:"Ø¥Ø¹Ù„Ø§Ù† Ù†Ø¯ÙˆØ© ØªØ¹Ø±ÙŠÙÙŠØ© â€” Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©",post2:"ÙØ¹Ø§Ù„ÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ© Ø¯Ø§Ø®Ù„ÙŠØ© â€” placeholder",
      profile:"Ø¨Ø±ÙˆÙØ§ÙŠÙ„",name:"Ø§Ù„Ø§Ø³Ù…",email:"Ø§Ù„Ø¨Ø±ÙŠØ¯",age:"Ø§Ù„Ø¹Ù…Ø±",batch:"Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹Ø©",saveLocal:"Ø­ÙØ¸ (Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø§Ù„Ø¢Ù†)",profileNote:"* ÙÙŠ Ù…Ø±Ø­Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‡Ù†Ø±Ø¨Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠ Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….",
      settings:"Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",language:"Ø§Ù„Ù„ØºØ©",customize:"ØªØ®ØµÙŠØµ",clearPrefs:"Ù…Ø³Ø­ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²",laterNote:"* Ù„Ø§Ø­Ù‚Ù‹Ø§ Ù‡Ù†Ø¶ÙŠÙ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±ÙØŒ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§ØªØŒ ÙˆÙ…Ø³Ø­ QR Ù„Ù„Ø­Ø¶ÙˆØ±.",
      tabHome:"ğŸ  Ø¹Ø§Ù…",tabProfile:"ğŸ‘¤ Ø¨Ø±ÙˆÙØ§ÙŠÙ„",tabSettings:"âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"},
    en:{title:"Kafr El-Sheikh Med Studentsâ€™ Union",ready:"Ready",desc:"Starter page to confirm GitHub Pages is working. We also link Firebase now, then weâ€™ll add Signâ€‘in, Posts, Profile, QR, etc.",
      badgeNote:"If the badge shows âœ“ Firebase linked, the link is OK.",fontSize:"Font size",fsDefault:"Default",fsLarge:"Large",fsXL:"Xâ€‘Large",
      theme:"Theme",toggleTheme:"Light/Dark",prefsNote:"* Preferences are saved locally. Advanced features require signâ€‘in.",
      publicPosts:"Public posts (placeholder)",post1:"Intro seminar announcement â€” will be replaced with real data",post2:"Internal sports event â€” placeholder",
      profile:"Profile",name:"Name",email:"Email",age:"Age",batch:"Batch No.",saveLocal:"Save (local)",profileNote:"* Will be linked to the user after signâ€‘in stage.",
      settings:"Settings",language:"Language",customize:"Customize",clearPrefs:"Clear local prefs",laterNote:"* Admin dashboard, approvals and QR attendance come next.",
      tabHome:"ğŸ  Home",tabProfile:"ğŸ‘¤ Profile",tabSettings:"âš™ï¸ Settings"}
  };
  const i18nElems=[...document.querySelectorAll('[data-i18n]')];
  function applyLang(lang){
    const d=dict[lang]||dict.ar;
    i18nElems.forEach(el=>{ const k=el.getAttribute('data-i18n'); if(d[k]) el.textContent=d[k]; });
    document.documentElement.lang = lang;
    document.dir = (lang==='ar' ? 'rtl' : 'ltr');
    localStorage.setItem('lang', lang);
    const sel=document.getElementById('langSel'); if(sel) sel.value=lang;
  }
  const savedLang=localStorage.getItem('lang')||'ar';
  applyLang(savedLang);
  const langSel=document.getElementById('langSel');
  if(langSel){ langSel.onchange=()=>applyLang(langSel.value); }
})();
</script>

<!-- ===== Firebase (Compat SDKs) ===== -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>
// Ù…ÙØ§ØªÙŠØ­ Ù…Ø´Ø±ÙˆØ¹Ùƒ (Client keys â€” Ø¹Ø§Ø¯ÙŠ ØªÙƒÙˆÙ† Ø¹Ø§Ù…Ø©)
const firebaseConfig = {
  apiKey: "AIzaSyDfiO-4J0DIHSKZo_vdBXeS343eJ0x4pYo",
  authDomain: "ittihad-med-kfs.firebaseapp.com",
  projectId: "ittihad-med-kfs",
  appId: "1:323302922960:web:3343605d75d2a5147cdcd5"
};

(function(){
  const badge = document.getElementById('statusBadge');
  const errBox = document.getElementById('errBox');
  const toast = (msg)=>{ errBox.textContent=msg; errBox.classList.add('show'); setTimeout(()=>errBox.classList.remove('show'),4000); };

  try{
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ÙƒØªØ§Ø¨Ø© Ø§Ø®ØªØ¨Ø§Ø±ÙŠØ© Ù„Ù„ÙƒØ´Ù Ø¹Ù† Rules
    db.collection('ping').doc('hello').set({time:new Date().toISOString(), page:location.href})
      .then(()=>{ badge.textContent='âœ“ Firebase Ù…Ø±ØªØ¨Ø·'; })
      .catch(e=>{
        badge.textContent='âš ï¸ Firestore error';
        if (e && e.code==='permission-denied') {
          toast('Firestore Permission Denied â€” Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ (Rules) Ø£Ùˆ Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„.');
        } else {
          toast('Firestore error: ' + (e.message||e));
        }
        console.error(e);
      });
  }catch(e){
    badge.textContent='âš ï¸ Init error';
    toast('Firebase init error: ' + (e.message||e));
    console.error(e);
  }
})();
</script>

<script>
/* ===== AUTH (Email + Google) + HOTFIX Ù„Ù„Ù…ÙˆØ¯Ø§Ù„ ===== */
(function(){
  const ADMINS = ['dr.emara10@gmail.com']; // ØªÙ‚Ø¯Ø± ØªØ²ÙˆØ¯ Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù†

  // Ø¹Ù†Ø§ØµØ±
  const modal   = document.getElementById('authModal');
  const openBtn = document.getElementById('btnOpenAuth');
  const closeBtn= document.getElementById('btnCloseAuth');
  const nameInp = document.getElementById('authName');
  const email   = document.getElementById('authEmail');
  const pass    = document.getElementById('authPass');
  const hint    = document.getElementById('authHint');
  const btnUp   = document.getElementById('btnEmailSignUp');
  const btnIn   = document.getElementById('btnEmailSignIn');
  const btnG    = document.getElementById('btnGoogle');
  const btnOut  = document.getElementById('btnSignOut');
  const badge   = document.getElementById('statusBadge');

  const auth = firebase.auth();
  const db   = firebase.firestore();

  // Hotfix: ÙØªØ­/Ù‚ÙÙ„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¯Ø§Ø¦Ù…Ù‹Ø§
  if(openBtn && modal) openBtn.onclick = ()=> modal.style.display='grid';
  if(closeBtn && modal) closeBtn.onclick= ()=> modal.style.display='none';
  window.addEventListener('click',e=>{ if(e.target===modal) modal.style.display='none'; });

  const L=s=>(s||'').trim();
  const lower=s=>L(s).toLowerCase();
  const isAdmin=u=>u && ADMINS.includes(lower(u.email||''));
  const toast=msg=>{ if(hint) hint.textContent=msg; };

  // ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯ + Ø§Ø³Ù… ÙØ±ÙŠØ¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù‡Ù†Ø±Ø¨Ø·Ù‡ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ù€ usernames)
  if(btnUp) btnUp.onclick = async ()=>{
    try{
      const n=L(nameInp.value), em=L(email.value), pw=pass.value;
      if(n.length<2) return toast('Ø§ÙƒØªØ¨ Ø§Ø³Ù… ØµØ­ÙŠØ­ (2 Ø­Ø±Ù ÙØ£ÙƒØ«Ø±)');
      const cred = await auth.createUserWithEmailAndPassword(em, pw);
      // Ø§Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
      await db.collection('users').doc(cred.user.uid).set({
        displayName:n, email:em, createdAt:firebase.firestore.FieldValue.serverTimestamp()
      }, {merge:true});
      toast('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ âœ”');
    }catch(e){ toast(e.message||String(e)); }
  };

  // Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯
  if(btnIn) btnIn.onclick = async ()=>{
    try{
      const em=L(email.value), pw=pass.value;
      await auth.signInWithEmailAndPassword(em,pw);
      modal.style.display='none';
    }catch(e){ toast(e.message||String(e)); }
  };

  // Ø¯Ø®ÙˆÙ„ Ø¨Ø¬ÙˆØ¬Ù„
  if(btnG) btnG.onclick = async ()=>{
    try{
      const provider = new firebase.auth.GoogleAuthProvider();
      await auth.signInWithPopup(provider);
      modal.style.display='none';
    }catch(e){ toast(e.message||String(e)); }
  };

  // Ø®Ø±ÙˆØ¬
  if(btnOut) btnOut.onclick = ()=> auth.signOut();

  // Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  auth.onAuthStateChanged(async (u)=>{
    if(u){
      badge.textContent = (isAdmin(u)?'ğŸ›¡ï¸ Ø£Ø¯Ù…Ù† â€” ':'Ø¹Ø¶Ùˆ â€” ') + (u.displayName||u.email);
      // Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ùˆ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯
      const ref=db.collection('users').doc(u.uid);
      const snap=await ref.get();
      if(!snap.exists){
        await ref.set({email:u.email||'', displayName:u.displayName||'', createdAt:firebase.firestore.FieldValue.serverTimestamp()});
      }
    }else{
      badge.textContent = 'âœ“ Firebase Ù…Ø±ØªØ¨Ø·';
    }
  });
})();
</script>

</body>
</html>
